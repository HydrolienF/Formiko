<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GCreature.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko</a> &gt; <span class="el_source">GCreature.java</span></div><h1>GCreature.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko;

import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.exceptions.EmptyListException;
import fr.formiko.usuel.exceptions.ListItemNotFoundException;
import fr.formiko.usuel.exceptions.NullItemException;
import fr.formiko.usuel.g;
import fr.formiko.usuel.listes.List;

import java.io.Serializable;
import java.util.Iterator;

public class GCreature implements Serializable{//, Iterator{
  protected CCreature début;
  protected CCreature fin;
  //TODO #82 replace début &amp; fin by a protected List&lt;Creature&gt;.
  // CONSTRUCTEUR -----------------------------------------------------------------
<span class="fc" id="L19">  public GCreature(CCreature cc){</span>
<span class="fc" id="L20">    début = cc; fin = cc;</span>
<span class="fc" id="L21">  }</span>
  public GCreature(Creature c){
<span class="nc" id="L23">    this(new CCreature(c));</span>
<span class="nc" id="L24">  }</span>
  public GCreature(){
<span class="fc" id="L26">    this((CCreature) null);</span>
<span class="fc" id="L27">  }</span>

  public GCreature(int nbrDeCreature, Fourmiliere fere, Espece e, CCase cc){
<span class="fc" id="L30">    this();</span>
<span class="fc" id="L31">    debug.débogage(&quot;Création d'un groupe de Fourmi avec au moins 1 fourmis.&quot;);</span>
<span class="fc" id="L32">    Fourmi reine = new Fourmi(fere,e, (byte) 0,(byte) 0);</span>
    //reine.setCCase(cc);
<span class="fc" id="L34">    addFin(reine);</span>
<span class="pc bpc" id="L35" title="1 of 2 branches missed.">    for (int i =1 ;i &lt; nbrDeCreature ;i++ ) {</span>
<span class="nc" id="L36">      Fourmi f = new Fourmi(fere,e,(byte) 3,(byte) 0,reine.getPheromone());</span>
      //f.setCCase(cc);
<span class="nc" id="L38">      addFin(f);</span>
    }
<span class="fc" id="L40">  }</span>
  // GET SET -----------------------------------------------------------------------
<span class="fc" id="L42">  public CCreature getDébut(){return début;}</span>
<span class="fc" id="L43">  public CCreature getFin(){return fin;}</span>
<span class="nc" id="L44">  public void setDébut(CCreature cc){début = cc;}</span>
  // Fonctions propre -----------------------------------------------------------
  public String toString(){
<span class="pc bpc" id="L47" title="1 of 2 branches missed.">    if (début==null){ return &quot;&quot;;}</span>
<span class="fc" id="L48">    return début.toString();</span>
<span class="nc" id="L49">  }public String gcToString(){return gcToString();}</span>
  public int length(){
<span class="fc bfc" id="L51" title="All 2 branches covered.">    if (début==null){</span>
<span class="fc" id="L52">      return 0;</span>
<span class="fc bfc" id="L53" title="All 2 branches covered.">    }else if(début.getContenu().equals(fin.getContenu())){</span>
<span class="fc" id="L54">      return 1;</span>
    }else {
<span class="fc" id="L56">      return début.length();</span>
    }
  }
  public Fourmi getReine(){
<span class="fc bfc" id="L60" title="All 2 branches covered.">    if (début==null){return null;}</span>
<span class="fc bfc" id="L61" title="All 2 branches covered.">    if (getDébut().getContenu() instanceof Fourmi){</span>
<span class="fc" id="L62">      Fourmi f1 = (Fourmi) getDébut().getContenu();</span>
<span class="fc bfc" id="L63" title="All 2 branches covered.">      if (f1.estReine()){//si c'est la reine</span>
<span class="fc" id="L64">        return f1;</span>
      }
    }
<span class="fc" id="L67">    return début.getReine();</span>
  }
  public Fourmi getPlusAffamée(){
<span class="nc bnc" id="L70" title="All 2 branches missed.">    if (début==null){return null;}</span>
<span class="nc" id="L71">    return début.getPlusAffamée();</span>
  }
  public GCreature getGcStade(int x){
<span class="pc bpc" id="L74" title="1 of 2 branches missed.">    if (début==null){return new GCreature();}</span>
<span class="fc" id="L75">    return début.getGcStade(x);</span>
  }
  public GCreature getGcType(int x){
<span class="pc bpc" id="L78" title="1 of 2 branches missed.">    if (début==null){return new GCreature();}</span>
<span class="fc" id="L79">    return début.getGcType(x);</span>
  }
  public GCreature getCouvain(){ // on renvoie d'habord les plus proches de la transformation en Fourmi adulte.
<span class="fc" id="L82">    GCreature gcr = getGcStade(-1);</span>
<span class="fc" id="L83">    gcr.add(getGcStade(-2));</span>
<span class="fc" id="L84">    gcr.add(getGcStade(-3));</span>
<span class="fc" id="L85">    return gcr;</span>
  }
  public Creature getCouvainSaleE()throws EmptyListException{
<span class="nc bnc" id="L88" title="All 2 branches missed.">    if (début==null){ throw new EmptyListException(&quot;GCreature&quot;,&quot;trouver la créature sale du couvain&quot;);}</span>
<span class="nc" id="L89">    return début.getCouvainSale();</span>
  }
  public Creature getCouvainSale(){
    try {
<span class="nc" id="L93">      return getCouvainSaleE();</span>
<span class="nc" id="L94">    }catch (EmptyListException e){return null;}</span>
  }
  public GCreature getCouvainsSale(){
<span class="nc" id="L97">    GCreature gcr = getCouvain();</span>
    // on garde le premier sale :
<span class="nc bnc" id="L99" title="All 2 branches missed.">    while (gcr.getDébut() != null){</span>
<span class="nc" id="L100">      Fourmi fTest = (Fourmi) gcr.getDébut().getContenu();</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">      if (fTest.getPropreté() &lt; 90) {</span>
<span class="nc" id="L102">        gcr.retirer(gcr.getDébut().getContenu());</span>
      }else{
        break;
      }
<span class="nc bnc" id="L106" title="All 2 branches missed.">    }if (gcr.getDébut() == null){ return new GCreature();}</span>
<span class="nc" id="L107">    gcr.getDébut().getCouvainsSale(); // on filtre les propre dans la suite de la liste.</span>
<span class="nc" id="L108">    return gcr;</span>
  }
  // a add :
  // public GCreature getGcSiMemeFere(Fourmiliere fere){}
  private Creature getCreatureParIdE(int id)throws EmptyListException{
<span class="pc bpc" id="L113" title="1 of 2 branches missed.">    if (début==null){ throw new EmptyListException(&quot;GCreature&quot;,&quot;trouver la créature &quot;+id);}</span>
<span class="fc bfc" id="L114" title="All 2 branches covered.">    if (début.getContenu().getId()==id){</span>
<span class="fc" id="L115">      return début.getContenu();</span>
    }else {
<span class="fc" id="L117">      return début.getCreatureParId(id);</span>
    }
  }
  public Creature getCreatureParId(int id){
    try {
<span class="fc" id="L122">      return getCreatureParIdE(id);</span>
<span class="nc" id="L123">    }catch (EmptyListException e) {return null;}</span>
  }
  public Fourmi getFourmiParId(int id){
<span class="fc" id="L126">    Creature c = getCreatureParId(id);</span>
<span class="pc bpc" id="L127" title="1 of 2 branches missed.">    if(c instanceof Fourmi){</span>
<span class="fc" id="L128">      return (Fourmi)c;</span>
    }else{
<span class="nc" id="L130">      erreur.erreur(&quot;La creature selectionné n'as pas put etre transformer en fourmi.&quot;);</span>
<span class="nc" id="L131">      return null;</span>
    }
  }
  private Fourmi getFourmiParFereE(Fourmiliere f)throws EmptyListException{
<span class="nc bnc" id="L135" title="All 2 branches missed.">    if (début==null){ throw new EmptyListException(&quot;GCreature&quot;,&quot;trouver la créature par fere&quot;);}</span>
<span class="nc" id="L136">    return début.getFourmiParFere(f);</span>
  }
  public Fourmi getFourmiParFere(Fourmiliere f){
    try {
<span class="nc" id="L140">      return getFourmiParFereE(f);</span>
<span class="nc" id="L141">    }catch (Exception e) {</span>
<span class="nc" id="L142">      return null;</span>
    }
  }
  private GCreature filtreAlliés(Creature c, int différenceTolléré){
<span class="pc bpc" id="L146" title="2 of 4 branches missed.">    if (début==null || c==null){ return new GCreature();}</span>
<span class="fc" id="L147">    return début.filtreAlliés(c,différenceTolléré);</span>
  }
  public GCreature filtreAlliés(Creature c){
<span class="pc bpc" id="L150" title="1 of 4 branches missed.">    int x=0; if(c.getEspece()!=null &amp;&amp; c.getEspece().getPolycalique()){x=5;}// en théorie 4 suffisent.</span>
<span class="fc" id="L151">    return filtreAlliés(c,x);</span>
  }
  /**
  *{@summary delete Creature that can't eat more.}&lt;br&gt;
  *@version 1.29
  */
  public GCreature filtreFaimMax(){
<span class="pc bpc" id="L158" title="1 of 2 branches missed.">    if (début==null){ return new GCreature();}</span>
<span class="fc" id="L159">    return début.filtreFaimMax();</span>
  }
  /**
  *{@summary delete Creature that can't be cleaner.}&lt;br&gt;
  *@version 1.29
  */
  public GCreature filtrePropreteMax(){
<span class="pc bpc" id="L166" title="1 of 2 branches missed.">    if (début==null){ return new GCreature();}</span>
<span class="fc" id="L167">    return début.filtrePropreteMax();</span>
  }
  /**
  *{@summary delete Creature that didn't whant food.}&lt;br&gt;
  *@version 1.29
  */
  public GCreature filtreWantFood(){
<span class="fc bfc" id="L174" title="All 2 branches covered.">    if (début==null){ return new GCreature();}</span>
<span class="fc" id="L175">    return début.filtreWantFood();</span>
  }
  /**
  *{@summary delete Creature that didn't whant clean.}&lt;br&gt;
  *@version 1.29
  */
  public GCreature filtreWantClean(){
<span class="fc bfc" id="L182" title="All 2 branches covered.">    if (début==null){ return new GCreature();}</span>
<span class="fc" id="L183">    return début.filtreWantClean();</span>
  }
  public void setLienFere(Fourmiliere fere){
<span class="nc bnc" id="L186" title="All 2 branches missed.">    if(début==null){ return;}</span>
<span class="nc" id="L187">    début.setLienFere(fere);</span>
<span class="nc" id="L188">  }</span>
<span class="nc" id="L189">  public int getNbrGcStade(int x){ return getGcStade(x).length();}</span>
<span class="nc" id="L190">  public int getNbrImago(){ return getNbrGcStade(0);}</span>
<span class="nc" id="L191">  public int getNbrReine(){ return getGcStade(0).getGcType(0).length();}</span>
  public int getNbrOuvriere(){
    try {
<span class="fc" id="L194">    return getGcStade(0).getGcType(3).length() + getGcStade(0).getGcType(4).length() + getGcStade(0).getGcType(5).length();</span>
<span class="nc" id="L195">    }catch (Exception e) {</span>
<span class="nc" id="L196">      erreur.erreur(&quot;Impossible de prende en compte les type major et minor dans les ouvrières.&quot;);</span>
<span class="nc" id="L197">      return getGcStade(0).getGcType(3).length();</span>
    }
  }
  public Espece getEspece(){
<span class="nc" id="L201">    Fourmi c = this.getReine();</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">    if(c!=null){return c.getEspece();}</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">    if(début!=null){return ((Fourmi)début.getContenu()).getEspece();}</span>
<span class="nc" id="L204">    return null;</span>
  }

  public int [] gcToTInt(){
<span class="nc bnc" id="L208" title="All 2 branches missed.">    if (début==null){ return null;}</span>
<span class="nc" id="L209">    return début.gcToTInt();</span>
  }
  public GCreature copier(){
<span class="nc bnc" id="L212" title="All 2 branches missed.">    if(début==null){ return new GCreature();}</span>
<span class="nc" id="L213">    return début.copier();</span>
  }
  public void actualiserFin(){
<span class="nc" id="L216">    CCreature cc = début;</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">    while(cc!=null){</span>
<span class="nc" id="L218">      cc=cc.getSuivant();</span>
    }
<span class="nc" id="L220">    fin = cc;</span>
<span class="nc" id="L221">  }</span>
  public GInsecte getGi(){
<span class="fc" id="L223">    GInsecte gi = new GInsecte();</span>
<span class="fc" id="L224">    CCreature cc = début;</span>
<span class="fc bfc" id="L225" title="All 2 branches covered.">    while(cc != null){</span>
<span class="fc" id="L226">      Creature c = cc.getContenu();</span>
<span class="fc bfc" id="L227" title="All 2 branches covered.">      if(c instanceof Insecte){gi.add((Insecte) cc.getContenu());}</span>
<span class="fc" id="L228">      cc = cc.getSuivant();</span>
<span class="fc" id="L229">    }</span>
<span class="fc" id="L230">    return gi;</span>
  }
  public void add(Creature c){
<span class="fc" id="L233">    addFin(c);</span>
<span class="fc" id="L234">  }</span>
  public void addFin(Creature c){
<span class="pc bpc" id="L236" title="1 of 2 branches missed.">    if(c==null){throw new NullItemException();}</span>
<span class="fc" id="L237">    CCreature cc = new CCreature(c);</span>
<span class="fc bfc" id="L238" title="All 2 branches covered.">    if (fin ==  null){</span>
<span class="fc" id="L239">      début = cc;</span>
<span class="fc" id="L240">      fin = cc;</span>
    }else {
<span class="fc" id="L242">      fin.setSuivant(cc);</span>
<span class="fc" id="L243">      cc.setPrécédent(fin);</span>
<span class="fc" id="L244">      fin = cc;</span>
    }
<span class="fc" id="L246">  }</span>
  public void add(GCreature gc){
<span class="pc bpc" id="L248" title="1 of 4 branches missed.">    if(gc == null || gc.getDébut() == null){ return;}</span>
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">    if (fin == null){</span>
<span class="fc" id="L250">      début = gc.getDébut();</span>
<span class="fc" id="L251">      fin = gc.getFin();</span>
    }else {
<span class="nc" id="L253">      fin.setSuivant(gc.getDébut());</span>
<span class="nc" id="L254">      gc.getDébut().setPrécédent(fin);</span>
<span class="nc" id="L255">      fin = gc.getFin();</span>
    }
<span class="fc" id="L257">  }</span>
  public void add(GInsecte gi ){
<span class="nc" id="L259">    GCreature gc = gi.toGCreature();</span>
<span class="nc" id="L260">    add(gc);</span>
<span class="nc" id="L261">  }</span>
  /**
  *{@summary remove an item from the list.} &lt;br&gt;
  *if list is empty or element fail to be remove an Exception will be throw.&lt;br&gt;
  *@version 1.31
  */
  public void remove(Creature c) {
<span class="pc bpc" id="L268" title="1 of 2 branches missed.">    if(c==null){ throw new NullItemException();}</span>
<span class="fc bfc" id="L269" title="All 2 branches covered.">    if(début == null){ throw new EmptyListException(&quot;GCreature&quot;,&quot;retirer la Creature &quot;+c.getId());}//erreur.erreur(&quot;Aucune créature n'as pu être retirer car GCreature est vide&quot;,&quot;GCreature.retirer&quot;,true); return;}</span>
<span class="fc bfc" id="L270" title="All 2 branches covered.">    if(début.getContenu().equals(c)){</span>
<span class="fc bfc" id="L271" title="All 2 branches covered.">      if(fin.getContenu().equals(c)){</span>
<span class="fc" id="L272">        début = null; fin = null; // on retire la seule créature</span>
      }else{
<span class="fc" id="L274">        début = début.getSuivant(); // on retire la 1a créature.</span>
      }
<span class="fc" id="L276">      return;</span>
    }
<span class="fc" id="L278">    début.retirer(c);</span>
    // On remet fin a la dennière case.
<span class="fc" id="L280">    fin = début;</span>
<span class="fc bfc" id="L281" title="All 2 branches covered.">    while(fin.getSuivant() != null){</span>
<span class="fc" id="L282">      fin = fin.getSuivant();</span>
    }
<span class="fc" id="L284">  }</span>
<span class="fc" id="L285">  public void retirer(Creature c){remove(c);}</span>
<span class="nc" id="L286">  public void delete(Creature c){retirer(c);}</span>
  public void afficheToiE() throws EmptyListException{
<span class="nc bnc" id="L288" title="All 2 branches missed.">    if(début==null){</span>
<span class="nc" id="L289">      throw new EmptyListException(&quot;GCreature&quot;,&quot;tout afficher&quot;);</span>
    }else{
<span class="nc" id="L291">      début.afficheTout();</span>
    }
<span class="nc" id="L293">  }</span>
  public void afficheToi(){
    try {
<span class="nc" id="L296">      afficheToiE();</span>
<span class="nc" id="L297">    }catch (EmptyListException e) {}</span>
<span class="nc" id="L298">  }</span>
  public void afficheToiRéduitE() throws EmptyListException{
<span class="nc bnc" id="L300" title="All 2 branches missed.">    if(début==null){</span>
<span class="nc" id="L301">      throw new EmptyListException(&quot;GCreature&quot;,&quot;tout afficher&quot;);</span>
    }else{
<span class="nc" id="L303">      System.out.print(g.get(&quot;listeCreature&quot;)+&quot; : &quot;);</span>
<span class="nc" id="L304">      début.afficheToutRéduit();</span>
    }
<span class="nc" id="L306">  }</span>
  public void afficheToiRéduit(){
    try {
<span class="nc" id="L309">      afficheToiRéduitE();</span>
<span class="nc" id="L310">    }catch (EmptyListException e) {}</span>
<span class="nc" id="L311">  }</span>
  /**
  *Play as an ant.
  *@version 1.33
  */
  private void jouerE() throws EmptyListException{
<span class="nc bnc" id="L317" title="All 2 branches missed.">    if(début == null){</span>
<span class="nc" id="L318">      throw new EmptyListException(&quot;GCreature&quot;,&quot;jouer&quot;);</span>
    }else{
<span class="nc" id="L320">      début.jouer();</span>
    }
<span class="nc" id="L322">  }</span>
  /**
  *Play as an ant.
  *@version 1.33
  */
  public void jouer(){
    try{
<span class="nc" id="L329">      jouerE();</span>
<span class="nc" id="L330">    }catch (EmptyListException e) {erreur.alerte(&quot;1 player can't play&quot;);}</span>
<span class="nc" id="L331">  }</span>
  /**
  *reset action before the turn of all the ant.
  *@version 1.30
  */
  private void preTourE() throws EmptyListException{
<span class="nc bnc" id="L337" title="All 2 branches missed.">    if(début == null){</span>
<span class="nc" id="L338">      throw new EmptyListException(&quot;GCreature&quot;,&quot;preTour&quot;);</span>
    }else{
<span class="nc" id="L340">      début.preTour();</span>
    }
<span class="nc" id="L342">  }</span>
  /**
  *reset action before the turn of all the ant.
  *@version 1.30
  */
  public void preTour(){
    try{
<span class="nc" id="L349">      preTourE();</span>
<span class="nc" id="L350">    }catch (EmptyListException e) {}</span>
<span class="nc" id="L351">  }</span>
  public void actualiserCaseSN(){
<span class="pc bpc" id="L353" title="1 of 2 branches missed.">    if(début == null){ return;}</span>
<span class="fc" id="L354">    début.actualiserCaseSN();</span>
<span class="fc" id="L355">  }</span>
  public void setPheromone(Pheromone ph){
<span class="nc bnc" id="L357" title="All 2 branches missed.">    if (début==null){ return;}</span>
<span class="nc" id="L358">    début.setPheromone(ph);</span>
<span class="nc" id="L359">  }</span>
  public void classerPourNetoyage(){
<span class="nc bnc" id="L361" title="All 2 branches missed.">    if (début==null){ return;}</span>
<span class="nc" id="L362">    début.classerPourNétoyage();</span>
<span class="nc" id="L363">  }</span>
  public int [] toTId(){
<span class="fc bfc" id="L365" title="All 2 branches covered.">    if (début==null){ return new int[0];}</span>
<span class="fc" id="L366">    return début.toTId();</span>
  }
  /**
  *{@summary Transform a GCreature in List&amp;lt;Creature&amp;gt;.}
  *@version 1.38
  */
  public List&lt;Creature&gt; toList(){
<span class="pc bpc" id="L373" title="1 of 2 branches missed.">    if (début==null){</span>
<span class="nc" id="L374">      List&lt;Creature&gt; lc = new List&lt;Creature&gt;();</span>
<span class="nc" id="L375">      return lc;</span>
    }
<span class="fc" id="L377">    return début.toList();</span>
  }
  //functions that use iterator
  public boolean aFiniDeJouer(){
<span class="nc" id="L381">    List&lt;Creature&gt; lc = toList();</span>
<span class="nc bnc" id="L382" title="All 2 branches missed.">    for (Creature c : lc ) {</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">      if(c.getAction()&gt;0){return false;}</span>
<span class="nc" id="L384">    }</span>
<span class="nc" id="L385">    return true;</span>
  }
  /**
  *{@summary Force all the GCreature Creature to end there turn.}&lt;br&gt;
  *Ant that still haven't end there turn will have action set to 0 &amp;#38; tour to update age, cleaning etc.
  */
  public boolean setAction0AndEndTurn(){
<span class="nc" id="L392">    List&lt;Creature&gt; lc = toList();</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">    for (Creature c : lc ) {</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">      if(c.getAction()&gt;0){</span>
<span class="nc" id="L395">        c.setAction(0);</span>
<span class="nc" id="L396">        c.tour();//force to do finTour() without any action ant will do nothing.</span>
      }
<span class="nc" id="L398">    }</span>
<span class="nc" id="L399">    return true;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>