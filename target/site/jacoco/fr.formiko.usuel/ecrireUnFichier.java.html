<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ecrireUnFichier.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.usuel</a> &gt; <span class="el_source">ecrireUnFichier.java</span></div><h1>ecrireUnFichier.java</h1><pre class="source lang-java linenums">package fr.formiko.usuel;

//def par défaut des fichiers depuis 0.79.5
import fr.formiko.usuel.tableau;
import java.io.File;
import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import fr.formiko.usuel.listes.GString;
import java.time.format.DateTimeFormatter;
import java.time.LocalDateTime;
import fr.formiko.usuel.types.str;

<span class="nc" id="L16">public class ecrireUnFichier {</span>

  public static boolean ecrireUnFichier(GString tableauDeLigne, String nomDuFichier) {
<span class="fc" id="L19">    nomDuFichier = str.sToDirectoryName(nomDuFichier);</span>
    try {
<span class="fc" id="L21">      BufferedWriter ecriteurAvecBuffer = null;</span>
      String ligne;

      try {
<span class="fc" id="L25">        ecriteurAvecBuffer = new BufferedWriter(new FileWriter(nomDuFichier));</span>
<span class="nc" id="L26">      } catch(FileNotFoundException e) {</span>
<span class="nc" id="L27">        erreur.erreur(&quot;Le fichier n'as pas pu être créer. Le problème peut venir d'un caractère incorecte&quot;);</span>
<span class="nc" id="L28">        return false;</span>
        //ecriteurAvecBuffer = new BufferedWriter(new FileWriter(&quot;sauvegarde/sauvegardeEnCasDErreur.txt&quot;));
  	    //e.printStackTrace();
<span class="fc" id="L31">      }</span>
<span class="fc" id="L32">      String contenu = tableauDeLigne.toStringLong();</span>
<span class="fc" id="L33">      ecriteurAvecBuffer.write(contenu);</span>
      /*for (String s : tableauDeLigne) {
        ecriteurAvecBuffer.write(s+&quot;\n&quot;);
      }*/
<span class="fc" id="L37">      ecriteurAvecBuffer.close();</span>
<span class="nc" id="L38">    }catch (IOException e) {</span>
<span class="nc" id="L39">      return false;</span>
      //e.printStackTrace();
<span class="fc" id="L41">    }</span>
<span class="fc" id="L42">    return true;</span>
  }
  public static void ecrireUnFichier(GString tableauDeLigne){
<span class="nc" id="L45">    String pseudo = &quot;X&quot;;</span>
<span class="nc" id="L46">    LocalDateTime date = LocalDateTime.now();</span>
<span class="nc" id="L47">    String dateFr = date.format(DateTimeFormatter.ofPattern(&quot;dd-MM-yyyy HH;mm;ss&quot;));</span>
<span class="nc" id="L48">    String nomDuFichier = read.getString(&quot;nomDuFichier&quot;,&quot; &quot;);</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">    if (nomDuFichier.equals(&quot; &quot;)){</span>
<span class="nc" id="L50">      nomDuFichier = pseudo + &quot; &quot;+ dateFr;</span>
    }else{
<span class="nc" id="L52">      char charInterdit [] = {'/','\\',':','*','?','&quot;','&lt;','&gt;','|'};</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">      if(opperationSurString.contientChar(nomDuFichier,charInterdit)){</span>
<span class="nc" id="L54">        erreur.alerte(&quot;Les char : \&quot; \\ / : * ? \&quot; &lt; &gt; | \&quot; sont interdit, vous ne pouvez pas les utiliser dans un nom de fichier ! (Il ont été retiré pour éviter les bogues)&quot;);</span>
<span class="nc" id="L55">        nomDuFichier = opperationSurString.retirerChar(nomDuFichier,charInterdit);</span>
      }
    }
<span class="nc bnc" id="L58" title="All 2 branches missed.">    if (nomDuFichier.length()==0){ nomDuFichier = &quot;sauvegardeEnCasDeNomDeFichierVide&quot;;}</span>
    /*File f = new File (nomDuFichier + &quot;.txt&quot;);
    if (!nomDuFichier.equals(&quot;sauvegarde&quot;) &amp;&amp; f.exists()){
      erreur.erreur(&quot;le nom de la sauvegarde éxiste déjà&quot;,&quot;ecrireUnFichier.ecrireUnFichier&quot;,&quot;Le nom du fichier sera sauvegardeX&quot;);
      nomDuFichier = &quot;sauvegarde&quot;;
      f = new File (&quot;sauvegarde/sauvegarde.txt&quot;);
    }
    int i=2;
    // test non éfficace pour éviter d'écraser un fichier.
    if (nomDuFichier.equals(&quot;sauvegarde&quot;) ){
      while (f.exists()){
        nomDuFichier = &quot;sauvegarde/sauvegarde&quot; + i;
        i++;
      }
    }*/
<span class="nc" id="L73">    ecrireUnFichier(tableauDeLigne, &quot;sauvegarde/&quot; + nomDuFichier + &quot;.txt&quot;);</span>
<span class="nc" id="L74">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>