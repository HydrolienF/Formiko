<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>sauvegarderUnePartie.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.usuel</a> &gt; <span class="el_source">sauvegarderUnePartie.java</span></div><h1>sauvegarderUnePartie.java</h1><pre class="source lang-java linenums">package fr.formiko.usuel;

import fr.formiko.formiko.Main;
import fr.formiko.formiko.ObjetAId;
import fr.formiko.formiko.Partie;
import fr.formiko.usuel.types.str;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

/**
 *{@summary Save a game.}&lt;br&gt;
 *@author Hydrolien
 *@version 1.38
 */
<span class="nc" id="L20">public class sauvegarderUnePartie {</span>
<span class="fc" id="L21">  private static ObjectOutputStream oos = null;</span>
<span class="fc" id="L22">  private static ObjectInputStream ois = null;</span>
<span class="fc" id="L23">  private static final String REP = Main.getFolder().getFolderSaves();</span>
<span class="fc" id="L24">  private static String s=&quot;null&quot;;</span>
  private static Save save;

  // GET SET -----------------------------------------------------------------------
<span class="fc" id="L28">  public static void setS(String s2){s=s2;}</span>
<span class="fc" id="L29">  public static String getRep(){return REP;}</span>
<span class="fc" id="L30">  public static String getNomDuFichierComplet(){return str.addALaFinSiNecessaire(REP+s,&quot;.save&quot;);}</span>
<span class="fc" id="L31">  public static Save getSave(){return save;}</span>
<span class="fc" id="L32">  public static void setSave(Save sa){save=sa;}</span>
  // Fonctions propre -----------------------------------------------------------
  /**
   *{@summary Save a Partie }&lt;br&gt;
   *It use the java tools to save in byte code a Serializable Object.
   *@param p The Partie to save
   *@param nomDuFichier The name of the output File (It will be place in REP/nomDuFichier.save)
   *@version 1.41
   */
  public static void sauvegarder(Partie p, String nomDuFichier){
    // setSave(Save.getSave());
<span class="fc" id="L43">    s=nomDuFichier;</span>
    try {
<span class="fc" id="L45">      oos = new ObjectOutputStream(new FileOutputStream(getNomDuFichierComplet()));</span>
<span class="fc" id="L46">      oos.writeObject(p);</span>
<span class="fc" id="L47">      oos.flush();//ca permet de bien nétoyer le flu si j'ai bien compris</span>
<span class="nc" id="L48">    }catch (Exception e) {</span>
<span class="nc" id="L49">      erreur.erreur(&quot;Impossible de sauvegarder la partie pour une raison inconnue&quot;);</span>
<span class="nc" id="L50">      return;</span>
<span class="fc" id="L51">    }</span>
<span class="fc" id="L52">    getSave().addSave();</span>
<span class="fc" id="L53">  }</span>
  /**
   *{@summary Load a Partie }&lt;br&gt;
   *It use the java tools to load in byte code a Serializable Object.
   *@param nomDuFichier The name of the input File (File will be REP/nomDuFichier.save)
   *@version 1.2
   */
  public static Partie charger(String nomDuFichier){
<span class="fc" id="L61">    s=nomDuFichier;</span>
<span class="fc" id="L62">    Partie pa = null;</span>
<span class="fc" id="L63">    debug.débogage(&quot;Chargement de la sauvegarde &quot;+s);</span>
    try {
<span class="fc" id="L65">      ois = new ObjectInputStream(new FileInputStream(getNomDuFichierComplet()));</span>
<span class="fc" id="L66">      pa = (Partie) ois.readObject();</span>
<span class="nc" id="L67">    }catch (Exception e) {</span>
<span class="nc" id="L68">      erreur.erreur(&quot;Impossible de charger la partie &quot;+nomDuFichier+&quot; pour une raison inconnue&quot;);</span>
<span class="fc" id="L69">    }</span>
<span class="fc" id="L70">    return pa;</span>
  }
  /**
  *{@summary Delete a save.}
  *@param nomDuFichier The name of the file to delete
  *@version 1.1
  */
  public static boolean supprimer(String nomDuFichier){
<span class="fc" id="L78">    s=nomDuFichier;</span>
<span class="fc" id="L79">    String s = sauvegarderUnePartie.getNomDuFichierComplet();</span>
<span class="fc" id="L80">    File f = new File(s);</span>
<span class="fc" id="L81">    return f.delete();</span>
  }
  /**
  *{@summary make a list with all save in a [] and return it.}&lt;br&gt;
  *return An array of every file aviable in REPSAVE sort in non-ascending order.&lt;br&gt;
  *@version 1.33
  */
  public static String [] listSave(){
<span class="nc" id="L89">    File f = new File(REP);</span>
<span class="nc" id="L90">    String r [] = f.list();</span>
<span class="nc" id="L91">    int lenr = r.length;</span>
<span class="nc" id="L92">    tableau.sort(r,false);</span>
<span class="nc" id="L93">    return r;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>