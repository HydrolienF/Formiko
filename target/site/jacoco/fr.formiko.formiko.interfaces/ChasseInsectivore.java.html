<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ChasseInsectivore.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko.interfaces</a> &gt; <span class="el_source">ChasseInsectivore.java</span></div><h1>ChasseInsectivore.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko.interfaces;

import fr.formiko.formiko.CCase;
import fr.formiko.formiko.Case;
import fr.formiko.formiko.Creature;
import fr.formiko.formiko.Fourmi;
import fr.formiko.formiko.GInsecte;
import fr.formiko.formiko.Insecte;
import fr.formiko.formiko.Main;
import fr.formiko.formiko.Message;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;
import fr.formiko.usuel.maths.math;

import java.io.Serializable;

/**
 * {@summary Ant implementation.}&lt;br&gt;
 * Allow an ant to do hunt&lt;br&gt;
 * Ant are able to see other ObjetSurCarteAId as Creature at 1 Case of distance.
 * @author Hydrolien
 * @version 1.1
 */
<span class="fc" id="L25">public class ChasseInsectivore implements Serializable, Chasse {</span>
  private Creature c;

<span class="fc" id="L28">  public void setC(Creature cTemp){c=cTemp;}</span>

  // Fonctions propre -----------------------------------------------------------
  /**
   * {@summary try to hunt or moove.}&lt;br&gt;
   * @param c The hunting Creature.
   * @param direction The direction were the Creature will go if any Prey is visible.
   * return true if c can hunt more.
   * @version 1.28
   */
  public boolean chasser(Creature c, int direction){
<span class="fc" id="L39">    setC(c);</span>
<span class="pc bpc" id="L40" title="1 of 2 branches missed.">    if(!canHuntMore()){return false;}</span>
<span class="fc" id="L41">    GInsecte proieVisible = getProie();</span>
<span class="pc bpc" id="L42" title="1 of 2 branches missed.">    if (c.getCCase().getContenu().getGi().getDébut() != null){ // Si il y a un insecte sur la même case</span>
<span class="fc" id="L43">      chasse(c);</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">    }else if (proieVisible.getDébut() != null){ // Si il y a un insecte a coté</span>
<span class="nc" id="L45">      CCase pointDeLaProie = proieVisible.getDébut().getInsecte().getCCase();</span>
<span class="nc bnc" id="L46" title="All 6 branches missed.">      if (Main.getDifficulté() &gt;= 1 || (c instanceof Fourmi &amp;&amp; c.getIa()==false)){ // en normal les ia chasse les insectes les plus intéressants sur la case ou elle sont.</span>
<span class="nc" id="L47">        pointDeLaProie = proieVisible.getDébut().getInsectePlusDeNourritureFournie().getCCase();</span>
      }
<span class="nc" id="L49">      debug.débogage(g.getM(&quot;laFourmi&quot;)+&quot; &quot; + c.getId()+ &quot; &quot;+g.get(&quot;ChasseInsectivore.1&quot;)+&quot; &quot; + pointDeLaProie.getPoint());</span>
<span class="nc" id="L50">      c.ceDeplacer(pointDeLaProie);</span>
<span class="nc" id="L51">    }else { // Si il n'y a pas d'insecte</span>
<span class="nc" id="L52">      c.ceDeplacer(direction);</span>
    }
<span class="fc" id="L54">    return canHuntMore();</span>
  }
  /**
   * {@summary actions during hunt.}&lt;br&gt;
   * An Ant kill an Insect in the same Case&lt;br&gt;
   * It can choose the first 1 or the better 1 depending on the difficulty.&lt;br&gt;
   * @param c The hunting Creature.
   * return true if c can hunt more.
   * @version 1.1
   */
  public boolean chasse(Creature c){
<span class="fc" id="L65">    setC(c);</span>
<span class="pc bpc" id="L66" title="1 of 2 branches missed.">    if(!canHuntMore()){return false;}</span>
    //chasse
<span class="fc" id="L68">    Case pointActuel = c.getCCase().getContenu();</span>
<span class="fc" id="L69">    GInsecte gi = pointActuel.getGi();</span>
<span class="fc" id="L70">    debug.débogage(&quot;Chasse : action = &quot;+c.getAction() + &quot;actionMax = &quot;+c.getActionMax());</span>
<span class="pc bpc" id="L71" title="1 of 2 branches missed.">    if (gi.getDébut() != null) { // sous forme de str I+id</span>
      Insecte insecteTue;
<span class="pc bpc" id="L73" title="5 of 6 branches missed.">      if (Main.getDifficulté() &gt;= 0 || ((c instanceof Fourmi) &amp;&amp; ((Fourmi)c).getFere().getJoueur().getIa()==false)){ // en normal les ia chasse les insectes les plus intéressants sur la case ou elle sont.</span>
<span class="fc" id="L74">        insecteTue = gi.getInsectePlusDeNourritureFournie();</span>
      }else{
<span class="nc" id="L76">        insecteTue = gi.getDébut().getContenu();</span>
      }
<span class="fc" id="L78">      tuer(insecteTue);</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">      if(!canHuntMore()){return false;}</span>
<span class="fc" id="L80">      depecer(insecteTue);</span>
    }
<span class="fc" id="L82">    return canHuntMore();</span>
  }

  //COMMENT FONCTIONNE LA CHASSE
  /**
   * {@summary fined a prey.}&lt;br&gt;
   * @version 1.1
   */
  public GInsecte getProie(){
    //TODO on dervrais plutot faire un GCreature pour pouvoir inclure des Fourmis et potentiellement retirer des insectes.
<span class="fc" id="L92">    return c.getCCase().getGi(1); // 1 est le rayon du cercle de case pris en compte.</span>
  }
  /**
   * {@summary kill during hunt.}&lt;br&gt;
   * An Ant kill an Insect&lt;br&gt;
   * @param insecteTue The insect that will die.
   * @version 1.1
   */
  public boolean tuer(Insecte insecteTue){
<span class="fc bfc" id="L101" title="All 2 branches covered.">    if (!insecteTue.getEstMort()){</span>
<span class="fc" id="L102">      Message m = new Message(g.getM(&quot;laCréature&quot;)+&quot; &quot;+ c.getId()+&quot; &quot;+g.get(&quot;ChasseInsectivore.2&quot;)+&quot; &quot; + insecteTue.getId(), ((Fourmi) c).getFourmiliere().getId(),2);</span>
<span class="fc" id="L103">      insecteTue.setEstMort(true);</span>
<span class="fc" id="L104">      setActionMoins(c);</span>
<span class="fc" id="L105">      debug.débogage(&quot;tuer l'insecte &quot;+insecteTue.getId()+&quot; effectué&quot;);</span>
<span class="fc" id="L106">      return true;</span>
    }else{
<span class="fc" id="L108">      return false;</span>
    }
  }
  /**
   * {@summary Butcher during hunt.}&lt;br&gt;
   * An Ant kill an Insect&lt;br&gt;
   * @param insecteTue The died Insect.
   * @version 1.1
   */
  public boolean depecer(Insecte insecteTue){
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">    if(insecteTue==null){return false;}</span>
<span class="fc" id="L119">    Message m = new Message(g.getM(&quot;laFourmi&quot;)+&quot; &quot;+ c.getId()+&quot; &quot;+g.get(&quot;ChasseFourmi.3&quot;)+&quot; &quot; + insecteTue.getId(), ((Fourmi) c).getFourmiliere().getId(),2);</span>
<span class="fc" id="L120">    debug.débogage(&quot;Nourriture fournie = &quot; + insecteTue.getNourritureFournie());</span>
<span class="fc" id="L121">    int nourriture = math.min(insecteTue.getNourritureFournie(),c.getNourritureMax()-c.getNourriture());</span>
<span class="pc bpc" id="L122" title="1 of 2 branches missed.">    if (insecteTue.getNourritureFournie()==nourriture){</span>
<span class="fc" id="L123">      insecteTue.supprimerDeLaCarte();</span>
    }else{
<span class="nc" id="L125">      insecteTue.setNourritureFournie(insecteTue.getNourritureFournie()-nourriture);</span>
    }
<span class="fc" id="L127">    c.ajouteNourriture(nourriture);</span>
<span class="fc" id="L128">    debug.débogage(&quot;dépecer l'insecte &quot;+insecteTue.getId()+&quot; effectué&quot;);</span>
<span class="fc" id="L129">    setActionMoins(c);</span>
<span class="fc" id="L130">    return true;</span>
  }
<span class="fc" id="L132">  public boolean canHuntMore(){return canHuntMore(c);}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>