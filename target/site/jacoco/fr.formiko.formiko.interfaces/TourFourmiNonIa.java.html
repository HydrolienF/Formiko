<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TourFourmiNonIa.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko.interfaces</a> &gt; <span class="el_source">TourFourmiNonIa.java</span></div><h1>TourFourmiNonIa.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko.interfaces;

import fr.formiko.formiko.*;
import fr.formiko.formiko.interfaces.TourFourmi;
import fr.formiko.views.gui2d.Question;
import fr.formiko.usuel.Temps;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.tableau;

import java.io.Serializable;

/**
 * {@summary Ant implementation for real player.&lt;br/&gt;}
 * Allow an ant to play a turn&lt;br/&gt;
 * @author Hydrolien
 * @version 1.30
 */
<span class="fc" id="L19">public class TourFourmiNonIa extends TourFourmi implements Serializable, Tour {</span>
  /**
  *{@summary Do turn actions for an ant.}
  *There is no order to do actions because player choose it.
  *@version 1.30
  */
  @Override
  public void tour(){
<span class="nc bnc" id="L27" title="All 4 branches missed.">    if(Main.getPartie()!=null &amp;&amp; !Main.getPartie().getContinuerLeJeu()){return;}</span>
    //if(Main.getPartie().getIdPlayingAnt()!=-1 &amp;&amp; Main.getPartie().getIdPlayingAnt()!=f.getId()){return;}
    try {
      //TODO move to View
<span class="nc" id="L31">      Main.getPj().setFActuelle(f);</span>
<span class="nc" id="L32">      Main.getPb().addPI();</span>
<span class="nc" id="L33">      Main.getPb().addPIJ();</span>
<span class="nc" id="L34">    }catch (Exception e) {</span>
<span class="nc" id="L35">      Main.getPartie().setPlayingAnt(f);</span>
<span class="nc" id="L36">      erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L37">    }</span>
<span class="nc bnc" id="L38" title="All 2 branches missed.">    if(Main.getOp().getAutoCleaning()){</span>
<span class="nc" id="L39">      cleanItself();</span>
    }
<span class="nc" id="L41">    String m = &quot;&quot;;</span>
<span class="nc" id="L42">    int choix = -1;</span>
<span class="nc" id="L43">    f.setMode(-1);//TODO #50 to remove.</span>
<span class="nc bnc" id="L44" title="All 6 branches missed.">    while(f.getAction()&gt;0 &amp;&amp; choix!=-2 &amp;&amp; f.getMode()==-1){</span>
<span class="nc" id="L45">      Temps.pause(50);</span>
<span class="nc" id="L46">      choix = (byte)(getChoixJoueur()-1);</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">      if(choix==-2){</span>
<span class="nc" id="L48">        return;</span>
      }
<span class="nc" id="L50">      m = faire(choix);</span>
<span class="nc bnc" id="L51" title="All 4 branches missed.">      if(choix==12 || choix==13){ //Main.getPs().setIdFourmiAjoué(-1);</span>
<span class="nc" id="L52">        return;</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">      }else if(choix==14){</span>
<span class="nc" id="L54">        f.setAction(0);</span>
<span class="nc" id="L55">        finTour();</span>
<span class="nc" id="L56">        Main.getPartie().setContinuerLeJeu(false);</span>
<span class="nc" id="L57">        return;</span>
      }
    }
<span class="nc bnc" id="L60" title="All 2 branches missed.">    if (f.getMode() == 0){</span>
<span class="nc" id="L61">      m = &quot;chasser / ce déplacer pour chasser (Ou Récolter des graines)&quot;;</span>
<span class="nc" id="L62">      f.eat(100);</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">    }else if(f.getMode() == 3){</span>
<span class="nc" id="L64">      backHomeAndShareFood(); m = &quot;Nourrir et Nétoyer&quot;;</span>
    }
    try {
<span class="nc" id="L67">      Main.getPs().setIdFourmiAjoué(-1);</span>
<span class="nc" id="L68">    }catch (Exception e) {</span>
<span class="nc" id="L69">      erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L70">    }</span>
<span class="nc" id="L71">    finTour();</span>
<span class="nc" id="L72">  }</span>



  // old part to choose the action to do with the ant.---------------------------
  public byte getChoixBouton(){
<span class="nc" id="L78">    byte choix = -1;</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">    while (choix==-1) {</span>
      try {
<span class="nc" id="L81">        choix = (byte) Main.getPj().getActionF();</span>
<span class="nc" id="L82">      }catch (Exception e) {</span>
<span class="nc" id="L83">        choix = (byte) Main.getView().getAntChoice(getTActionFourmi());</span>
<span class="nc" id="L84">        erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L85">      }</span>
<span class="nc" id="L86">      Temps.pause(50);</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">      if (f.getBUneSeuleAction()){</span>
        //TODO move to View
        try {
<span class="nc" id="L90">          Main.getPb().removePa();</span>
<span class="nc" id="L91">          Main.getPb().addPa(getTActionFourmi());</span>
<span class="nc" id="L92">        }catch (Exception e) {</span>
<span class="nc" id="L93">          erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L94">        }</span>
<span class="nc" id="L95">        f.setBUneSeuleAction(false);</span>
      }
      /*if(bActualiserTaille){
        Main.getPs().actualiserTailleMax();
        Main.getPs().revalidate();
        Main.repaint();
        bActualiserTaille=false;
      }*/
<span class="nc" id="L103">    }choix++;</span>
<span class="nc" id="L104">    return choix;</span>
  }
  public byte getChoixJoueur(){
<span class="nc" id="L107">    int [] t = getTActionFourmi();</span>
    try {
<span class="nc" id="L109">      Main.getPb().removePa();</span>
<span class="nc" id="L110">      Main.getPb().addPa(t);</span>
<span class="nc" id="L111">    }catch (Exception e) {</span>
<span class="nc" id="L112">      erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L113">    }</span>
    // on attend une action de la fenetre.
<span class="nc" id="L115">    debug.débogage(&quot;lancement de l'attente du bouton&quot;);</span>
<span class="nc" id="L116">    byte choix = getChoixBouton();</span>
<span class="nc" id="L117">    debug.débogage(&quot;action de Fourmi lancé &quot;+choix);</span>
    try {
<span class="nc" id="L119">      Main.getPj().setActionF(-1); //TODO move to View</span>
<span class="nc" id="L120">    }catch (Exception e) {</span>
<span class="nc" id="L121">      erreur.alerteGUI2Dfail(&quot;TourFourmiNonIa&quot;);</span>
<span class="nc" id="L122">    }</span>
<span class="nc" id="L123">    return choix;</span>
  }
  private int [] getTActionFourmi(){
<span class="nc bnc" id="L126" title="All 2 branches missed.">    if(f.getUneSeuleAction()!=-1){</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">      if(f.getUneSeuleAction()==20){return new int[0];}</span>
<span class="nc" id="L128">      int t []= new int [1];</span>
<span class="nc" id="L129">      t[0]=(int)f.getUneSeuleAction();</span>
<span class="nc" id="L130">      return t;</span>
    }
<span class="nc" id="L132">    int t []=new int [11];</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">    for (int i=0;i&lt;11 ;i++ ) {</span>
<span class="nc" id="L134">      t[i]=i;</span>
    }
<span class="nc" id="L136">    GCreature gcCase = f.getCCase().getContenu().getGc();</span>
<span class="nc bnc" id="L137" title="All 2 branches missed.">    if(f.getIndividu().getCoutDéplacement() == -1){ t=tableau.retirerX(t,0);}</span>
<span class="nc bnc" id="L138" title="All 6 branches missed.">    if(f.getIndividu().getCoutChasse() == -1 || gcCase.getGi().length()==0 || !f.chasse.canHuntMore(f)){ t=tableau.retirerX(t,1);}</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">    if(!f.canLay()){ t=tableau.retirerX(t,2);}</span>
<span class="nc bnc" id="L140" title="All 6 branches missed.">    if(f.getIndividu().getCoutTrophallaxie() == -1 || gcCase.filtreAlliés(f).filtreFaimMax().length() &lt; 2 || f.getNourriture()&lt;1){ t=tableau.retirerX(t,3);}</span>
<span class="nc bnc" id="L141" title="All 4 branches missed.">    if(f.getIndividu().getCoutNétoyer() == -1 ||(f.netoyer.getNombreDeCreatureANetoyer(f))==0){ t=tableau.retirerX(t,4);}</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">    if(!f.getEspece().getGranivore()){</span>
<span class="nc" id="L143">      t=tableau.retirerX(t,5);</span>
<span class="nc" id="L144">      t=tableau.retirerX(t,6);</span>
    }
<span class="nc" id="L146">    return t;</span>
  }
  private String faire(int choix){
<span class="nc bnc" id="L149" title="All 15 branches missed.">    String m = switch(choix){</span>
      case 0 :
<span class="nc" id="L151">        f.ceDeplacer(f.getFere().getJoueur().getIa());</span>
<span class="nc" id="L152">        yield &quot;ceDeplacer&quot;;</span>
      case 1 :
<span class="nc" id="L154">        f.chasse();</span>
<span class="nc" id="L155">        yield &quot;chasse&quot;;</span>
      case 2 :
<span class="nc" id="L157">        f.pondre();</span>
<span class="nc" id="L158">        yield &quot;pondre&quot;;</span>
      case 3 :
<span class="nc" id="L160">        f.trophallaxer();</span>
<span class="nc" id="L161">        yield &quot;trophallaxer&quot;;</span>
      case 4:
<span class="nc" id="L163">        f.netoyer();</span>
<span class="nc" id="L164">        yield &quot;ce netoyer ou nétoyer une autre fourmi&quot;;</span>
      case 5:
        //mangerGraine();
<span class="nc" id="L167">        yield &quot;mangerGraine&quot;;</span>
      case 6 :
        //casserGraine();
<span class="nc" id="L170">        yield &quot;casserGraine&quot;;</span>
      case 7 :
<span class="nc" id="L172">        f.setMode(0);</span>
<span class="nc" id="L173">        yield &quot;setMode0&quot;;</span>
      case 8 :
<span class="nc" id="L175">        f.setMode(3);</span>
<span class="nc" id="L176">        yield &quot;setMode1&quot;;</span>
      case 9 :
<span class="nc" id="L178">        f.setAction(0);</span>
<span class="nc" id="L179">        yield &quot;ne rien faire&quot;;</span>
      case 10 :
        try {
<span class="nc" id="L182">          Question q = new Question(&quot;supprimerFourmi.1&quot;,&quot;supprimerFourmi.2&quot;);</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">          if(q.getChoix()){</span>
<span class="nc" id="L184">            f.mourir(4);</span>
<span class="nc" id="L185">            yield &quot;supprimer la fourmi&quot;;</span>
          }
<span class="nc" id="L187">          yield &quot;ne pas supprimer la fourmi&quot;;</span>
<span class="nc" id="L188">        }catch (Exception e) {</span>
<span class="nc" id="L189">          f.mourir(4);</span>
<span class="nc" id="L190">          yield &quot;supprimer la fourmi&quot;;</span>
        }
      case 12 :
<span class="nc" id="L193">        yield &quot;change Fourmi&quot;;</span>
      case 13 :
<span class="nc" id="L195">        f.getFere().getGc().setAction0AndEndTurn();</span>
<span class="nc" id="L196">        yield &quot;endTurn&quot;;</span>
      case 14 :
<span class="nc" id="L198">        yield &quot;endGame&quot;;</span>
      default :
<span class="nc" id="L200">        yield &quot;le choix &quot;+choix+&quot; n'est pas possible&quot;;</span>
      };
<span class="nc" id="L202">    return m;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>