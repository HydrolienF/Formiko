<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NetoyerFourmi.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko.interfaces</a> &gt; <span class="el_source">NetoyerFourmi.java</span></div><h1>NetoyerFourmi.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko.interfaces;

import fr.formiko.formiko.*;
import fr.formiko.views.gui2d.BoiteListeDefilante;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;
import fr.formiko.usuel.tableau;
import fr.formiko.usuel.types.str;

import java.io.Serializable;

/**
 * {@summary Ant implementation.}&lt;br&gt;
 * Allow an ant to clean itself or an other Creature&lt;br&gt;
 * @author Hydrolien
 * @version 1.1
 */
<span class="fc" id="L19">public class NetoyerFourmi implements Serializable, Netoyer {</span>
  private Fourmi cible;
  private Fourmi net;
  // Fonctions propre -----------------------------------------------------------
  /**
   *{@summary An AI ant want to clean.}&lt;br&gt;
   *@param c The cleaning ant.
   *@return true only if ant realy clean someone.
   *@version 1.3
   */
  public boolean netoyerIa(Creature c){
<span class="nc bnc" id="L30" title="All 2 branches missed.">    if(!(c instanceof Fourmi)){ erreur.erreur(&quot;Impossible de netoyer en tant que Fourmi avec la créature &quot;+c.getId()); return false;}</span>
<span class="nc" id="L31">    net = (Fourmi)c;</span>
<span class="nc" id="L32">    cible = (Fourmi) net.getCCase().getContenu().getGc().filtreAlliés(net).getCouvainSale();</span>
<span class="nc bnc" id="L33" title="All 2 branches missed.">    if (cible == null){ return false;}</span>
<span class="nc" id="L34">    netoyerPrivate();</span>
<span class="nc" id="L35">    return true;</span>
  }
  /**
   *{@summary A non-AI ant want to clean.}&lt;br&gt;
   *@param c The cleaning ant.
   *@version 1.3
   */
  public void netoyer(Creature c){
<span class="nc bnc" id="L43" title="All 2 branches missed.">    if(!(c instanceof Fourmi)){ erreur.erreur(&quot;Impossible de netoyer en tant que Fourmi avec la créature &quot;+c.getId()); return;}</span>
<span class="nc" id="L44">    net = ((Fourmi)(c));</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">    if(netoyerChoix()){//défini cible.</span>
<span class="nc" id="L46">      netoyerPrivate();</span>
    }
<span class="nc" id="L48">  }</span>
  /**
   *{@summary An ant clean a Creature.}&lt;br&gt;
   *@param c The cleaning ant.
   *@param c2 The cleaned ant.
   *@version 1.3
   */
  public void netoyer(Creature c, Creature c2){
<span class="pc bpc" id="L56" title="1 of 2 branches missed.">    if(!(c instanceof Fourmi)){ erreur.erreur(&quot;Impossible de netoyer en tant que Fourmi avec la créature &quot;+c.getId()); return;}</span>
<span class="pc bpc" id="L57" title="1 of 2 branches missed.">    if(!(c2 instanceof Fourmi)){ erreur.erreur(&quot;Impossible de ce faire netoyer en tant que Fourmi avec la créature &quot;+c2.getId()); return;}</span>
<span class="fc" id="L58">    net = (Fourmi)c;</span>
<span class="fc" id="L59">    cible = (Fourmi)c2;</span>
<span class="fc" id="L60">    netoyerPrivate();</span>
<span class="fc" id="L61">  }</span>
  /**
   *{@summary get number of non-100% clean ant.}&lt;br&gt;
   *@param c The cleaning ant.
   *@return the number of non-100% clean ant.
   *@version 1.3
   */
  public int getNombreDeCreatureANetoyer(Creature c){
<span class="nc bnc" id="L69" title="All 2 branches missed.">    if(c instanceof Fourmi){</span>
<span class="nc" id="L70">      net = (Fourmi)c;</span>
<span class="nc" id="L71">      return getFourmiPasPropre().length;</span>
    }else{
<span class="nc" id="L73">      return 0;</span>
    }
  }

  //sous fonctions
  /**
   *{@summary Let a player choose the ant that he want to clean.}&lt;br&gt;
   *@return true if the player chose an ant to clean.
   *@version 1.3
   */
  private boolean netoyerChoix(){  // permet de définir cible.
<span class="nc" id="L84">    GCreature gc = net.getCCase().getContenu().getGc();</span>
<span class="nc" id="L85">    int lengc = gc.length();</span>
    //TODO filtrer les fourmi déja propre.
<span class="nc bnc" id="L87" title="All 2 branches missed.">    if(lengc&lt;2){ cible = net;</span>
      //System.out.println(&quot;1 seule fourmi.&quot;);
    }
    else{
<span class="nc" id="L91">      int t[] = getFourmiPasPropre();</span>
<span class="nc" id="L92">      int lent = t.length;</span>
<span class="nc" id="L93">      String s[] = new String[lent];</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">      for (int i=0;i&lt;lent ;i++ ) {</span>
<span class="nc" id="L95">        Creature c = gc.getCreatureParId(t[i]);</span>
        //a ce stade toutes les fourmis de la liste devrais être sales.
<span class="nc" id="L97">        s[i]=t[i]+&quot; : &quot;+c.getProprete()+&quot;/&quot;+&quot;100&quot;+&quot; &quot;+g.get(&quot;propreté&quot;);</span>
      }
<span class="nc bnc" id="L99" title="All 2 branches missed.">      if(s.length==0){</span>
<span class="nc" id="L100">        return false;</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">      }else if(s.length==1){</span>
<span class="nc" id="L102">        String sTemp = s[0];</span>
<span class="nc" id="L103">        String tsSplit [] = sTemp.split(&quot; &quot;);</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">        if(tsSplit.length &gt;= 1){</span>
<span class="nc" id="L105">          sTemp = tsSplit[0];</span>
        }
<span class="nc" id="L107">        int x=str.sToI(sTemp);</span>
<span class="nc" id="L108">        cible = net.getCCase().getContenu().getGc().getFourmiParId(x);</span>
<span class="nc" id="L109">      }else{</span>
<span class="nc" id="L110">        BoiteListeDefilante bld = new BoiteListeDefilante();</span>
<span class="nc" id="L111">        int x = bld.getChoixId(s,g.get(&quot;pti.desc.5&quot;));</span>
<span class="nc" id="L112">        cible = net.getCCase().getContenu().getGc().getFourmiParId(x);</span>
      }
    }
<span class="nc" id="L115">    return true;</span>
  }
  /*public boolean netoyerTtLeMonde(){
    Fourmi fSale = null;//(Fourmi) this.getAlliéSurLaCase().getCouvainSaleMêmeTrèsPeu();
    if (fSale == null){ return false;}
    netoyer(fSale);
    return true;
  }*/
  /**
   *{@summary do the real cleaning action between cible ant net.}&lt;br&gt;
   *@version 1.3
   */
  private void netoyerPrivate(){
<span class="fc" id="L128">    cible.setPropreté(cible.getPropreté()+net.getIndividu().getNétoyage());</span>
<span class="fc" id="L129">    net.setActionMoins(net.getIndividu().getCoutNétoyer());</span>
<span class="fc" id="L130">  }</span>
  /**
   *{@summary get non-100% clean ant sort by cleaning level.}&lt;br&gt;
   *@return the non-100% clean ant sort by cleaning level on the same Case.
   *@version 1.3
   */
  private int [] getFourmiParOrdreDeSaletéSurLaCase(){
<span class="nc" id="L137">    GCreature gcTemp = net.getCCase().getContenu().getGc().filtreAlliés(net);</span>
<span class="nc" id="L138">    gcTemp.classerPourNetoyage(); // on récupère l'ordre définie dans CCreature pour le netoyage.</span>
<span class="nc" id="L139">    int lentr = gcTemp.length();</span>
<span class="nc" id="L140">    return gcTemp.gcToTInt();</span>
  }
  /**
   *{@summary get non-100% clean ant.}&lt;br&gt;
   *@return the non-100% clean ant.
   *@version 1.3
   */
  private int [] getFourmiPasPropre(){
<span class="nc" id="L148">    GCreature gc = net.getAlliéSurLaCase();</span>
<span class="nc" id="L149">    int t[] = getFourmiParOrdreDeSaletéSurLaCase();int lent = t.length;</span>
<span class="nc" id="L150">    int lentr = 0;</span>
    //on compte le nombre de case.
<span class="nc bnc" id="L152" title="All 2 branches missed.">    for (int i=0;i&lt;lent ;i++ ) {</span>
<span class="nc" id="L153">      Creature c = gc.getCreatureParId(t[i]);</span>
<span class="nc bnc" id="L154" title="All 2 branches missed.">      if(c.getProprete()&lt;100){</span>
<span class="nc" id="L155">        lentr++;</span>
      }
    }
    //on ajoute seuelement les fourmis qui sont sale.
<span class="nc" id="L159">    int tr[] = new int[lentr];int k=0;</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">    for (int i=0;i&lt;lent ;i++ ) {</span>
<span class="nc" id="L161">      Creature c = gc.getCreatureParId(t[i]);</span>
<span class="nc bnc" id="L162" title="All 2 branches missed.">      if(c.getProprete()&lt;100){</span>
<span class="nc" id="L163">        tr[k] = t[i];k++;</span>
      }
    }
<span class="nc" id="L166">    return tr;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>