<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ChasseGranivore.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko.interfaces</a> &gt; <span class="el_source">ChasseGranivore.java</span></div><h1>ChasseGranivore.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko.interfaces;

import fr.formiko.formiko.CCase;
import fr.formiko.formiko.Case;
import fr.formiko.formiko.Creature;
import fr.formiko.formiko.Fourmi;
import fr.formiko.formiko.GGraine;
import fr.formiko.formiko.Graine;
import fr.formiko.formiko.Insecte;
import fr.formiko.formiko.Main;
import fr.formiko.formiko.Message;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;

import java.io.Serializable;

/**
 * {@summary Ant implementation.}&lt;br&gt;
 * Allow an ant to do hunt&lt;br&gt;
 * Ant are able to see other ObjetSurCarteAId as Creature at 1 Case of distance.
 * @author Hydrolien
 * @version 1.40
 */
<span class="fc" id="L24">public class ChasseGranivore implements Serializable, Chasse {</span>
  private Creature c;

<span class="fc" id="L27">  public void setC(Creature cTemp){c=cTemp;}</span>

  // Fonctions propre -----------------------------------------------------------
  /**
   *{@summary collect seeds.}&lt;br&gt;
   *Ant search a seed. If it see a seed on the same Case it take it. If it see a seed on an other Case it goes to the Case.&lt;br&gt;
   *It can choose the first 1 or the better 1 depending on the difficulty.&lt;br&gt;
   *@param c The collecting ant.
   *@version 1.40
   */
  public boolean chasser(Creature c, int direction){
<span class="fc" id="L38">    setC(c);</span>
<span class="pc bpc" id="L39" title="1 of 2 branches missed.">    if(!canHuntMore()){return eatIfNeed();}</span>
<span class="fc" id="L40">    GGraine proieVisible = getProie();</span>
<span class="fc bfc" id="L41" title="All 2 branches covered.">    if (c.getCCase().getContenu().getGg().getDébut() != null){ // Si il y a une graine sur la même case</span>
<span class="fc" id="L42">      debug.débogage(&quot;la graine &quot;+c.getCCase().getContenu().getGg().getDébut().getContenu().getId()+&quot; a été détecté sur la meme case que la Fourmi.&quot;);</span>
<span class="fc" id="L43">      debug.débogage(&quot;la fourmi est en &quot;+c.getCCase().getContenu().description());</span>
<span class="fc" id="L44">      return chasse(c);</span>
<span class="fc bfc" id="L45" title="All 2 branches covered.">    }else if (proieVisible.getDébut() != null){ // Si il y a une graine a coté</span>
<span class="fc" id="L46">      CCase pointDeLaProie = proieVisible.getDébut().getContenu().getCCase();</span>
<span class="fc" id="L47">      Graine betterSeed = proieVisible.getGrainePlusDeNourritureFournieSansDureté();</span>
<span class="pc bpc" id="L48" title="1 of 6 branches missed.">      if ((Main.getDifficulté() &gt;= 1 || !c.getIa()) &amp;&amp; betterSeed!= null){</span>
<span class="fc" id="L49">        pointDeLaProie = betterSeed.getCCase();</span>
      }
<span class="fc" id="L51">      debug.débogage(&quot;La fourmi &quot; + c.getId()+ &quot; a vue une proie en &quot; + pointDeLaProie.getPoint());</span>
<span class="fc" id="L52">      c.ceDeplacer(pointDeLaProie);</span>
<span class="fc" id="L53">    }else { // Si il n'y a pas de graine visible</span>
<span class="fc" id="L54">      c.ceDeplacer(direction);</span>
    }
<span class="fc" id="L56">    return canHuntMore();</span>
  }
  /**
   * {@summary actions during hunt.}&lt;br&gt;
   * An Ant kill an Insect in the same Case&lt;br&gt;
   * It can choose the first 1 or the better 1 depending on the difficulty.&lt;br&gt;
   * @param c The hunting Creature.
   * return true if c can hunt more.
   * @version 1.40
   */
   public boolean chasse(Creature c){
<span class="fc" id="L67">     setC(c);</span>
<span class="fc bfc" id="L68" title="All 2 branches covered.">     if(!canHuntMore()){return false;}</span>
<span class="fc" id="L69">     GGraine gg = c.getCCase().getContenu().getGg();</span>
<span class="pc bpc" id="L70" title="1 of 2 branches missed.">     if (gg.getDébut() != null){</span>
       Graine graineCollecté;
<span class="pc bpc" id="L72" title="1 of 4 branches missed.">       if (Main.getDifficulté() &gt;= 0 || !c.getIa()){</span>
<span class="fc" id="L73">         graineCollecté = gg.getGrainePlusDeNourritureFournieSansDureté();</span>
       }else{
<span class="fc" id="L75">         graineCollecté = gg.getDébut().getContenu();</span>
       }
<span class="fc" id="L77">       debug.débogage(&quot;Suppression de la graine &quot;+graineCollecté.getId() + &quot; en &quot;+graineCollecté.getCCase().getContenu().description());</span>
<span class="fc" id="L78">       c.setTransported(graineCollecté);</span>
<span class="fc" id="L79">       setActionMoins(c);</span>
<span class="fc" id="L80">     }else{</span>
<span class="nc" id="L81">       erreur.alerte(&quot;La fonction collecte ne devrais pas être appeler sur une case vide.&quot;);</span>
     }
<span class="fc" id="L83">     return canHuntMore();</span>
   }

  //COMMENT FONCTIONNE LA CHASSE
  /**
   * {@summary fined a prey.}&lt;br&gt;
   * @version 1.40
   */
  private GGraine getProie(){
<span class="fc" id="L92">    return c.getCCase().getGg(1); // 1 est le rayon du cercle de case pris en compte.</span>
  }
<span class="fc" id="L94">  public boolean canHuntMore(){return canHuntMore(c);}</span>
  /**
   * {@summary Check if can hunt.}&lt;br&gt;
   * It should use Chasse.canHuntMore &amp;#38; specifics conditions for granivore species.&lt;br&gt;
   * @version 1.40
   */
  //@Override
  public boolean canHuntMore(Creature c){
    //return c.getTransported()==null &amp;&amp; super.canHuntMore(c);
<span class="fc bfc" id="L103" title="All 6 branches covered.">    return c.getTransported()==null &amp;&amp; c.getNourriture()&lt;c.getNourritureMax() &amp;&amp; c.getAction()&gt;0;</span>
  }
  private boolean eatIfNeed(){
    // if(c.isHungry(90)){
    //   if(){//peux ouvrir la graine qu'elle porte et la manger
    //     //ouvrir puis manger ou juste manger.
    //   }else{
    //     if(!(c instanceof Fourmi)){
    //       return false;
    //     }else if((Fourmi c).estALaFere()){
    //       //choisir une graine mangeable.
    //       //if n'as pas pris de graine return false;
    //     }else{
    //
    //     }
    //   }
    //   return true;
    // }
<span class="nc" id="L121">    return false;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>