<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PondreReine.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.formiko.interfaces</a> &gt; <span class="el_source">PondreReine.java</span></div><h1>PondreReine.java</h1><pre class="source lang-java linenums">package fr.formiko.formiko.interfaces;

import fr.formiko.formiko.Creature;
import fr.formiko.formiko.Fourmi;
import fr.formiko.formiko.Fourmiliere;
import fr.formiko.formiko.Main;
import fr.formiko.formiko.Message;
import fr.formiko.views.gui2d.PanneauTInt;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;
import fr.formiko.usuel.maths.allea;
import fr.formiko.usuel.read;
import fr.formiko.usuel.tableau;

import java.io.Serializable;

/**
 * {@summary Ant queen implementation.}&lt;br&gt;
 * Allow an ant queen to lay&lt;br&gt;
 * @author Hydrolien
 * @version 1.1
 */
<span class="fc" id="L24">public class PondreReine implements Serializable, Pondre{</span>
<span class="fc" id="L25">  private static int FOOD_COST_TO_LAY = 12;</span>
  private Fourmi f;
  /**
  *Lay an egg with Creature c
  *@version 1.13
  */
  public void unePonte(Creature c){
<span class="fc" id="L32">    debug.débogage(&quot;la créature &quot;+c.getId()+&quot; tente de pondre&quot;);</span>
<span class="pc bpc" id="L33" title="1 of 2 branches missed.">    if(c instanceof Fourmi){</span>
<span class="fc" id="L34">      f = (Fourmi) c;</span>
<span class="fc" id="L35">      pondre();</span>
<span class="fc" id="L36">      debug.débogage(&quot;fin de la ponte&quot;);</span>
    }else{
<span class="nc" id="L38">      erreur.erreurType(&quot;Fourmi&quot;);</span>
    }
<span class="fc" id="L40">  }</span>
  /**
  *{@summary Return true if can lay an egg.}
  *@version 1.41
  */
  public boolean canLay(Creature c){
<span class="fc bfc" id="L46" title="All 2 branches covered.">    if(c.getAction()&lt;1){return false;}</span>
<span class="fc bfc" id="L47" title="All 2 branches covered.">    if(c.getNourriture()&lt;=FOOD_COST_TO_LAY+1){return false;}</span>
<span class="fc bfc" id="L48" title="All 2 branches covered.">    if (c instanceof Fourmi) {</span>
<span class="fc" id="L49">      return ((Fourmi)c).estALaFere();</span>
    }
<span class="fc" id="L51">    return true;</span>
  }
  /**
  *Lay an egg.
  *@version 1.13
  */
  protected void pondre(){
    // Ne s'execute que si la reine a suffisement de nourriture et qu'elle est a sa fourmilière
    // diminue la nourriture de la reine.
    // génère une fourmi avec un age négatif et un mouvement nul jusqu'a sa naissance. (a la fourmilière)
<span class="fc" id="L61">    Fourmiliere fere = f.getFourmiliere();</span>
<span class="pc bpc" id="L62" title="1 of 2 branches missed.">    if (canLay(f)){ // f.getP().equals(p.getPointDelaFouriliere)</span>
      //byte type = choixType(); // 0 et 1 sont a évité en début de jeu.
<span class="fc" id="L64">      byte type = 3;</span>
<span class="fc" id="L65">      Fourmi fm = new Fourmi(f.getFourmiliere(),f.getEspece(),type);</span>
<span class="fc" id="L66">      fere.getGc().add(fm); //TODO remove when doing #190</span>
<span class="fc" id="L67">      fm.setAgeMax((int)((double)(f.getEspece().getIndividuParType(type).getAgeMax(0)*fm.getMultiplicateurDeDiff())));</span>
      //f.getFourmiliere().getCCase().getContenu().getGc().add(fm);
      //fere.getGc().add(fm); l'ajout a la fourmilière ce fait dans le constructeur de Fourmi.
<span class="fc" id="L70">      f.setNourriture(f.getNourriture() - FOOD_COST_TO_LAY);</span>
<span class="fc" id="L71">      Message m = new Message(&quot;La fourmi &quot; +fm.getId() + &quot; est née.&quot;, fere.getId(), 3);</span>
<span class="fc" id="L72">      f.setActionMoins(f.getIndividu().getCoutPondre());</span>
<span class="fc" id="L73">      f.setAilesCoupees(true);//une reine qui pond n'as plus d'ailes.</span>
    }
<span class="fc" id="L75">  }</span>
  //TODO #131
  /**
  *Choose a typeF for the egg.
  *@version 1.13
  */
  protected byte choixType(){
<span class="nc bnc" id="L82" title="All 2 branches missed.">    if (!f.getFere().getJoueur().getIa()){</span>
<span class="nc" id="L83">      int ti[] = f.getEspece().getTypeDIndividu();</span>
      //byte x = (byte) read.getInt(0,10,&quot;type de l'oeuf&quot;,3);
<span class="nc" id="L85">      Main.getPp().getPj().addPti(ti,3);</span>
<span class="nc" id="L86">      tableau.afficher(ti);</span>
<span class="nc" id="L87">      byte x = (byte) PanneauTInt.getChoixId();</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">      if(f.getEspece().getGIndividu().getIndividuParType(x) != null){</span>
<span class="nc" id="L89">        return x;</span>
      }
<span class="nc" id="L91">      erreur.erreur(&quot;Le type spécifié par le joueur n'est pas défini pour cette Espece.&quot;,&quot;3 est le type choisi a la place.&quot;,false);</span>
<span class="nc" id="L92">      return 3;</span>
    }
    //ia
<span class="nc bnc" id="L95" title="All 2 branches missed.">    if (f.getFere().getGc().length() &lt; f.getEspece().getNbrDIndividuMax()/10){ // si la fourmilière n'est pas encore a 10% de son dévelloppement max pas de fourmi de type 0 ou 1.</span>
<span class="nc" id="L96">      return 3; // si il y a un type 4 ou 2 il faudrait pouvoir en faire naitre de temps en temps.</span>
    }else{
<span class="nc" id="L98">      int x = allea.getAlléa(5);</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">      if(x == 0){ return 0;} // Reine.</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">      if(x == 1){ return 1;} // Male.</span>
<span class="nc" id="L101">      return 3; // ouvrière.</span>
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>