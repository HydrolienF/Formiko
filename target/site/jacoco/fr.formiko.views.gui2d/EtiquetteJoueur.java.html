<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EtiquetteJoueur.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.views.gui2d</a> &gt; <span class="el_source">EtiquetteJoueur.java</span></div><h1>EtiquetteJoueur.java</h1><pre class="source lang-java linenums">package fr.formiko.views.gui2d;

import fr.formiko.formiko.Joueur;
import fr.formiko.formiko.Main;
import fr.formiko.formiko.Pheromone;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import javax.swing.JComboBox;
import javax.swing.JTextField;

public class EtiquetteJoueur extends Panneau{
  private static int idCpt; private final int id;
  private Champ dsc;
  private boolean ia;
  private boolean ouvert;
  private ComboBox&lt;String&gt; combo;
  private Champ couleur;
  // CONSTRUCTEUR ---------------------------------------------------------------
<span class="nc" id="L29">  public EtiquetteJoueur(String s, Boolean b){</span>
<span class="nc" id="L30">    id =idCpt; idCpt++;</span>
<span class="nc" id="L31">    setOpaque(false);</span>
<span class="nc" id="L32">    dsc = new Champ();</span>
<span class="nc bnc" id="L33" title="All 2 branches missed.">    if(b!=null){ dsc.setText(s);}</span>
<span class="nc" id="L34">    else{dsc.setText(&quot;&quot;);}</span>
<span class="nc" id="L35">    dsc.setFondTransparent();</span>
<span class="nc" id="L36">    dsc.setBorder(null);</span>
<span class="nc" id="L37">    ItemState2 is2 = new ItemState2();</span>
<span class="nc" id="L38">    is2.setEj(this);</span>
<span class="nc" id="L39">    add(dsc);</span>
<span class="nc" id="L40">    String[] tab = {g.getM(&quot;joueur&quot;), g.getM(&quot;ia&quot;), g.getM(&quot;fermé&quot;)};</span>
<span class="nc" id="L41">    combo = new ComboBox&lt;String&gt;(tab);</span>
<span class="nc" id="L42">    couleur=new Champ();</span>
<span class="nc" id="L43">    couleur.setFondTransparent();</span>
<span class="nc" id="L44">    couleur.setBorder(null);</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">    if(b==null){ ouvert=false; combo.setSelectedIndex(2);}</span>
<span class="nc" id="L46">    else{ouvert=true;ia=b;iniCouleur();}</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">    if(ia){combo.setSelectedIndex(1);}</span>
<span class="nc" id="L48">    ItemState is = new ItemState();</span>
<span class="nc" id="L49">    combo.addItemListener(is);</span>
<span class="nc" id="L50">    combo.setFont(Main.getFont1(0.9));</span>
<span class="nc" id="L51">    is.setEj(this);</span>
<span class="nc" id="L52">    add(combo);</span>
<span class="nc" id="L53">    add(couleur);</span>

<span class="nc" id="L55">  }</span>
  public EtiquetteJoueur(boolean b){
<span class="nc" id="L57">    this(Joueur.get1Pseudo(),b);</span>
<span class="nc" id="L58">  }</span>
  public EtiquetteJoueur(){
<span class="nc" id="L60">    this(Joueur.get1Pseudo(),null);</span>
<span class="nc" id="L61">  }</span>

  // GET SET --------------------------------------------------------------------
<span class="nc" id="L64">  public int getId(){return id;}</span>
<span class="nc" id="L65">  public String getPseudo(){return dsc.getText();}</span>
<span class="nc" id="L66">  public void setPseudo(String s){dsc.setText(s);}</span>
<span class="nc" id="L67">  public boolean getIa(){return ia;}</span>
<span class="nc" id="L68">  public void setIa(boolean b){ia=b;}</span>
<span class="nc" id="L69">  public boolean getOuvert(){return ouvert;}</span>
<span class="nc" id="L70">  public void setOuvert(Boolean b){ouvert=b;}</span>
<span class="nc" id="L71">  public Pheromone getCouleur(){return Pheromone.sToPh(couleur.getText());}</span>
  // Fonctions propre -----------------------------------------------------------
  public String toString(){
<span class="nc" id="L74">    return getPseudo() +&quot; id:&quot;+ id + &quot; ia:&quot;+getIa()+&quot; ouvert:&quot;+getOuvert();</span>
  }
  /**
  *{@summary Standard equals function with id.}
  *Null &amp;#38; other class type proof.
  *@param o o is the Object to test. It can be null or something else than this class.
  *@version 1.31
  */
  @Override
  public boolean equals(Object o){
<span class="nc bnc" id="L84" title="All 4 branches missed.">    if(o==null || !(o instanceof EtiquetteJoueur)){return false;}</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">    return getId()==((EtiquetteJoueur)(o)).getId();</span>
  }
  public void paintComponent(Graphics g){
<span class="nc" id="L88">    Graphics2D g2d = (Graphics2D)g;</span>
<span class="nc" id="L89">    int taille = Main.getF().getWidth()/2;</span>
<span class="nc" id="L90">    int arrondi = Desc.getDimY();</span>
    Color col;
<span class="nc bnc" id="L92" title="All 2 branches missed.">    if(ouvert){</span>
<span class="nc" id="L93">      Pheromone ph = getCouleur();</span>
<span class="nc" id="L94">      col = ph.phToColor();</span>
<span class="nc" id="L95">    }else{</span>
<span class="nc" id="L96">      col = new Color(200,200,200);</span>
    }
<span class="nc bnc" id="L98" title="All 2 branches missed.">    if(col.getRed()+col.getGreen()+col.getBlue() &lt; 400){</span>
<span class="nc" id="L99">      dsc.setForeground(Color.WHITE);</span>
<span class="nc" id="L100">      couleur.setForeground(Color.WHITE);</span>
    }else{
<span class="nc" id="L102">      dsc.setForeground(Color.BLACK);</span>
<span class="nc" id="L103">      couleur.setForeground(Color.BLACK);</span>
    }
    //g2d.setColor(new Color(col.getRed(),col.getGreen(),col.getBlue(),152));
<span class="nc" id="L106">    g2d.setColor(col); // une couleur sans transparence pour évité d'avoir a redessiner toute la fenetre.</span>
<span class="nc" id="L107">    g2d.fillRoundRect(0,0,taille*7/10+taille/7,Desc.getDimY()*2,arrondi,arrondi);</span>
<span class="nc" id="L108">    dsc.setBounds(Desc.getDimY()/2,0,taille*5/10-Desc.getDimY()/4);</span>
<span class="nc" id="L109">    combo.setBounds(taille*5/10,0,taille/7,Desc.getDimY());</span>
<span class="nc" id="L110">    couleur.setBounds(taille*5/10+taille/7,0,taille/7,Desc.getDimY());</span>
    //add un bouton changer la couleur alléatoirement
<span class="nc" id="L112">    g2d.setColor(new Color(0,0,0));</span>
<span class="nc" id="L113">    peintBordure(g2d,taille,arrondi);</span>
<span class="nc" id="L114">  }</span>
  public void peintBordure(Graphics2D g, int taille, int arrondi){
<span class="nc" id="L116">    byte x = 3;//Main.getBordureBouton();</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">    if(x&lt;1){return;}</span>
<span class="nc" id="L118">    BasicStroke ligne = new BasicStroke(x);</span>
<span class="nc" id="L119">    g.setStroke(ligne);</span>
<span class="nc" id="L120">    g.drawRoundRect(0,0,taille*7/10+taille/7,Desc.getDimY()*2,arrondi,arrondi);</span>
<span class="nc" id="L121">  }</span>
  public void afficheToi(){
<span class="nc" id="L123">    System.out.println(this);</span>
<span class="nc" id="L124">  }</span>
  public void iniCouleur(){
<span class="nc" id="L126">    couleur.setText(new Pheromone().phToS());</span>
<span class="nc" id="L127">  }</span>

  //Classe interne implémentant l'interface ItemListener
<span class="nc" id="L130">  class ItemState implements ItemListener{</span>
    public EtiquetteJoueur ej;
    public void itemStateChanged(ItemEvent e) {
<span class="nc" id="L133">      debug.débogage(&quot;événement déclenché sur : &quot; + e.getItem());</span>
<span class="nc" id="L134">      PanneauNouvellePartie pnp = Main.getPnp();</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">      if(e.getStateChange()==1){ // si l'action est bien sélectionner.</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if(combo.getItemAt(0).equals(e.getItem())){</span>
<span class="nc" id="L137">          ouvert=true; ia=false; setPseudo(g.getM(&quot;joueur&quot;)+&quot; &quot;+(id+1));</span>
          //if ((combo.getSelectedItemReminder()).equals(combo.getItemAt(2))){
<span class="nc" id="L139">            iniCouleur();</span>
          //}
<span class="nc bnc" id="L141" title="All 2 branches missed.">        }else if(combo.getItemAt(1).equals(e.getItem())){</span>
<span class="nc" id="L142">          ouvert=true; ia=true; setPseudo(Joueur.get1Pseudo());</span>
          //if ((combo.getSelectedItemReminder()).equals(combo.getItemAt(2))){
<span class="nc" id="L144">            iniCouleur();</span>
          //}
<span class="nc bnc" id="L146" title="All 2 branches missed.">        }else if(combo.getItemAt(2).equals(e.getItem())){</span>
          //if(ej.equals(pnp.getGej().getFin().getContenu())){}
<span class="nc" id="L148">          ouvert=false;</span>
<span class="nc" id="L149">          pnp.getGej().retirer(ej);</span>
<span class="nc" id="L150">          pnp.rafraichirPgej();</span>
          //on retire l'EtiquetteJoueur.
          //Main.getPnp().get...
        }
      }
<span class="nc bnc" id="L155" title="All 2 branches missed.">      if(pnp.getGej().getFin().getContenu().getOuvert()){ // si la dernière n'est pas fermé.</span>
<span class="nc" id="L156">        pnp.getGej().add(new EtiquetteJoueur());</span>
<span class="nc" id="L157">        pnp.rafraichirPgej();</span>
      }
<span class="nc" id="L159">      pnp.repaint();</span>
<span class="nc" id="L160">    }</span>
<span class="nc" id="L161">    public void setEj(EtiquetteJoueur ejTemp){ ej=ejTemp;}</span>
  }
<span class="nc" id="L163">  class ItemState2 implements KeyListener{</span>
    public EtiquetteJoueur ej;
    public void keyReleased(KeyEvent e) {
<span class="nc" id="L166">      Main.getPnp().getPGej().repaint();</span>
<span class="nc" id="L167">    }</span>
<span class="nc" id="L168">    public void keyPressed(KeyEvent e){}</span>
<span class="nc" id="L169">    public void keyTyped(KeyEvent e){}</span>
<span class="nc" id="L170">    public void setEj(EtiquetteJoueur ejTemp){ ej=ejTemp;}</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>