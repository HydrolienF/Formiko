<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>action.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.views.gui2d</a> &gt; <span class="el_source">action.java</span></div><h1>action.java</h1><pre class="source lang-java linenums">package fr.formiko.views.gui2d;

import fr.formiko.formiko.Main;
import fr.formiko.formiko.Partie;
import fr.formiko.usuel.Temps;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;
import fr.formiko.usuel.sauvegarderUnePartie;
import fr.formiko.usuel.types.str;


import javax.swing.JOptionPane;

/**
*{@summary All the gui action are launch here.}
*@author Hydrolien
*@version 1.41
*/
<span class="nc" id="L20">public class action{</span>
  private static Partie pa;
  // GET SET -------------------------------------------------------------------
<span class="nc" id="L23">  public static Partie getPartie(){ return pa;}</span>
<span class="nc" id="L24">  public static void setPartie(Partie p){pa=p;}</span>
  // FUNCTIONS -----------------------------------------------------------------
  /**
  *{@summary Launch an action on gui mode.}
  *@version 1.41
  */
  public static void doAction(int action){
<span class="nc bnc" id="L31" title="All 4 branches missed.">    if(Main.getPe() != null &amp;&amp; Main.getPe().getVisible()){</span>
<span class="nc" id="L32">      doActionPe(action);</span>
<span class="nc bnc" id="L33" title="All 4 branches missed.">    }else if(Main.getPlayingAnt()!=null || Main.getPch()!=null){ //TODO replace by if getActionGameOn()</span>
<span class="nc" id="L34">      doActionPj(action);</span>
    }else{
<span class="nc" id="L36">      doActionPm(action);</span>
    }
<span class="nc" id="L38">  }</span>
  /**
  *{@summary Launch an action on menu.}
  *@version 1.41
  */
  public static void doActionPm(int ac){//TODO passer dans une autre class Controleur ?
<span class="nc" id="L44">    PanneauMenu pm = Main.getPm();</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">    if(ac==0){</span>

<span class="nc bnc" id="L47" title="All 2 branches missed.">    }else if(ac==1){</span>
<span class="nc" id="L48">      pm.setMenu(1);</span>
<span class="nc" id="L49">      Main.repaint();</span>
<span class="nc" id="L50">      pm.actualiserText();</span>
<span class="nc bnc" id="L51" title="All 2 branches missed.">    }else if(ac==2){</span>
<span class="nc" id="L52">      pm.addPcp();</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">    }else if(ac==3){</span>
<span class="nc" id="L54">      erreur.erreurPasEncoreImplemente();</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">    }else if(ac==4){</span>
<span class="nc" id="L56">      debug.débogage(&quot;lancementNouvellePartie&quot;);</span>
<span class="nc" id="L57">      pm.setLancer(true);</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">    }else if(ac==5){</span>
<span class="nc" id="L59">      pm.addPnp();</span>
<span class="nc bnc" id="L60" title="All 2 branches missed.">    }else if(ac==6){</span>
<span class="nc" id="L61">      Main.setTuto(true);</span>
<span class="nc" id="L62">      pm.setLancer(true);</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">    }else if(ac==100){</span>
<span class="nc" id="L64">      pa=Main.getPnp().getPartie();</span>
<span class="nc" id="L65">      pm.setLancer(true);</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">    }else if(ac==101){</span>
<span class="nc" id="L67">      pa=pm.getPcp().getPartie();</span>
<span class="nc" id="L68">      pm.setLancer(true);</span>
    }
<span class="nc" id="L70">  }</span>
  /**
  *{@summary Launch an action on action game.}
  *@version 1.41
  */
  public static void doActionPj(int ac){
<span class="nc" id="L76">    debug.débogage(&quot;action pj : &quot;+ac);</span>
    try {
<span class="nc bnc" id="L78" title="All 4 branches missed.">      if(Main.getPe()==null || !Main.getPe().getVisible()){</span>
<span class="nc bnc" id="L79" title="All 4 branches missed.">        if(ac &lt; 9 &amp;&amp; ac &gt; -1){</span>
<span class="nc" id="L80">          Main.getPj().actionZoom((byte)ac);</span>
<span class="nc bnc" id="L81" title="All 4 branches missed.">        }else if(ac&gt;=20 &amp;&amp; ac&lt;=31){</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">          if(Main.getPlayingAnt()==null){</span>
<span class="nc" id="L83">            erreur.erreur(&quot;aucune fourmi n'est selectionné pour réaliser l'action voulue.&quot;);</span>
          }else{
<span class="nc" id="L85">            debug.débogage(&quot;clic qui lance &quot;+(ac-20));</span>
<span class="nc" id="L86">            Main.getPb().setActionF(ac-20);</span>
          }
<span class="nc" id="L88">          Main.repaint();</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">        }else if(ac==111){</span>
<span class="nc" id="L90">          Main.getPch().setLancer(true);</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">        }else if(ac==112){//retour au menu</span>
<span class="nc" id="L92">          Main.setRetournerAuMenu(true);</span>
          //en suite on doit revenir quasiment a la void main.
<span class="nc bnc" id="L94" title="All 2 branches missed.">        }else if(ac==113){//retour au jeu</span>
<span class="nc" id="L95">          Main.getPj().removePfp();</span>
<span class="nc" id="L96">          Main.getPartie().setContinuerLeJeu(true);</span>
<span class="nc" id="L97">          Main.repaint();</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">        }else if(ac&gt;=40){</span>
<span class="nc" id="L99">          PanneauBouton pb = Main.getPb();</span>
<span class="nc" id="L100">          pb.setChoixId(pb.getPti().getBoutonX(ac-40));</span>
<span class="nc" id="L101">          pb.remove(pb.getPti());</span>
<span class="nc" id="L102">          pb.setPti(new PanneauTInt(null,pb));</span>
<span class="nc" id="L103">          Main.repaint();</span>
        }
      }
<span class="nc" id="L106">    }catch (Exception e) {</span>
<span class="nc" id="L107">      erreur.erreur(&quot;L'action &quot;+ac+&quot; n'as pas fonctionnée&quot;);</span>
<span class="nc" id="L108">    }</span>
<span class="nc" id="L109">  }</span>
  /**
  *{@summary Launch an escape panel action.}
  *@version 1.41
  */
  private static void doActionPe(int ac){
<span class="nc bnc" id="L115" title="All 2 branches missed.">    if(ac==-9){</span>
<span class="nc" id="L116">      Main.getScript().setCmdSuivante(true);</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">    }else if(ac==-10){</span>
<span class="nc" id="L118">      String s = getSaveName();</span>
<span class="nc" id="L119">      sauvegarderUnePartie.sauvegarder(Main.getPartie(),s+&quot;.save&quot;);</span>
<span class="nc" id="L120">      Main.getPe().setVisible(false);</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">    }else if(ac==-11){</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">    }else if(ac==-12){</span>

<span class="nc bnc" id="L125" title="All 2 branches missed.">    }else if(ac==-13){</span>
<span class="nc" id="L126">      retournerAuMenu();</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">    }else if(ac==-14){</span>
<span class="nc" id="L128">      Main.getF().quit();</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">    }else if(ac==-15){</span>
<span class="nc" id="L130">      Main.getPe().setVisible(false);</span>
    }
<span class="nc" id="L132">  }</span>
  /**
  *{@summary Ask save name in gui.}
  *@version 1.41
  */
  private static String getSaveName(){
<span class="nc" id="L138">    String s = &quot;null&quot;;</span>
<span class="nc" id="L139">    JOptionPane d = new JOptionPane(g.get(&quot;sauvegarder&quot;));</span>
<span class="nc" id="L140">    d.setMessageType(JOptionPane.QUESTION_MESSAGE);</span>
    //d.setInitialSelectionValue(Temps.getDatePourSauvegarde());
<span class="nc" id="L142">    Object[] options = {g.get(&quot;ok&quot;)};</span>
    //d.title = g.get(&quot;sauvegarder&quot;);
<span class="nc" id="L144">    String saveName = g.getM(&quot;sauvegarde&quot;)+&quot; &quot;+sauvegarderUnePartie.getSave().getIdS();//donne un identifiant unique au fichier.</span>
    try {
      //saveName+=&quot;  &quot;+Main.getGj().getDébut().getContenu().getPseudo();
<span class="nc" id="L147">      saveName+=&quot;  &quot;+Temps.getDatePourSauvegarde();</span>
<span class="nc" id="L148">    }catch (Exception e) {</span>
<span class="nc" id="L149">      erreur.alerte(&quot;Un nom de sauvegarde n'a pas pu être choisi.&quot;);</span>
<span class="nc" id="L150">    }</span>
<span class="nc" id="L151">    saveName = str.sToFileName(saveName);//le pseudo pourrai contenir des char interdits sur des fichiers.</span>
<span class="nc" id="L152">    s = d.showInputDialog(Main.getF(),g.get(&quot;save.message&quot;),saveName);</span>
<span class="nc" id="L153">    s = str.sToFileName(s);</span>
    //s = d.showInputDialog(Main.getF(),g.get(&quot;save.message&quot;),g.get(&quot;sauvegarder&quot;),JOptionPane.QUESTION_MESSAGE);
<span class="nc" id="L155">    Object o = g.get(&quot;save.message&quot;);</span>
<span class="nc" id="L156">    Object oNull = null;</span>
    //TODO s'arranger pour conserver ce qu'on a mais avoir 1 seul bouton g.get(&quot;ok&quot;) &amp; on veut le titre et la valeur préremplie.
    //javadoc showInputDialog(Component parentComponent, Object message, String title, int messageType, Icon icon, Object[] selectionValues, Object initialSelectionValue)
    //s = d.showInputDialog(Main.getF(),o,g.get(&quot;sauvegarder&quot;),JOptionPane.QUESTION_MESSAGE,new ImageIcon(),options,oNull);
<span class="nc" id="L160">    return s;</span>
  }
  /**
  *{@summary go back to main menu.}
  *@version 1.41
  */
  public static void retournerAuMenu(){
<span class="nc" id="L167">    Main.setRetournerAuMenu(true);//ne prend effet dans la void main que lorsque le tour est fini.</span>
    try {
<span class="nc" id="L169">      Main.getGj().setAction0AndEndTurn();//empèche une autre fourmi de jouer</span>
<span class="nc" id="L170">      Main.getPb().setActionF(9);//empèche la fourmi actuel de jouer.</span>
<span class="nc" id="L171">    }catch (Exception e) {}</span>
<span class="nc" id="L172">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>