<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>keys.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Formiko</a> &gt; <a href="index.source.html" class="el_package">fr.formiko.views.gui2d</a> &gt; <span class="el_source">keys.java</span></div><h1>keys.java</h1><pre class="source lang-java linenums">package fr.formiko.views.gui2d;

import fr.formiko.formiko.Main;
import fr.formiko.usuel.debug;
import fr.formiko.usuel.erreur;
import fr.formiko.usuel.g;

import java.awt.Event;
import java.awt.event.ActionEvent;
import java.awt.event.InputEvent;
import java.awt.event.KeyEvent;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.ActionMap;
import javax.swing.InputMap;
import javax.swing.JComponent;
import javax.swing.KeyStroke;

/**
*{@summary Key file that will launch all keys commands in gui2d.}&lt;br&gt;
*@author Hydrolien
*@version 1.40
*/
<span class="nc" id="L24">public class keys {</span>
  /**
  *{@summary Add keys listeners for all gui part.}
  *@version 1.40
  */
  public static void addBindings(){
<span class="nc" id="L30">    addActionToActionMap();</span>
<span class="nc" id="L31">    InputMap inputMap = Main.getPp().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);</span>

<span class="nc" id="L33">    inputMap.put(KeyStroke.getKeyStroke((char)27),&quot;escape&quot;);</span>
<span class="nc" id="L34">    inputMap.put(KeyStroke.getKeyStroke('\n'), &quot;enter&quot;);</span>
<span class="nc bnc" id="L35" title="All 2 branches missed.">    for (int i=20; i&lt;31; i++ ) {</span>
<span class="nc" id="L36">      inputMap.put(KeyStroke.getKeyStroke((char)Main.getKey(i+&quot;&quot;)), &quot;antAction&quot;);</span>
    }

    // inputMap.put(KeyStroke.getKeyStroke('S',InputEvent.CTRL_DOWN_MASK), &quot;save&quot;);
<span class="nc" id="L40">  }</span>
  /**
  *{@summary Add actions to use with listeners for all gui part.}
  *@version 1.40
  */
  private static void addActionToActionMap(){
<span class="nc" id="L46">    ActionMap actionMap = Main.getF().getPp().getActionMap();</span>

    //globals actions
<span class="nc" id="L49">    Action action = new AbstractAction() {</span>
      /**
      *{@summary Show or hide escape panel.}
      *@version 1.40
      */
      public void actionPerformed(ActionEvent actionEvent) {
<span class="nc bnc" id="L55" title="All 2 branches missed.">        if(!Main.getView().getActionGameOn()){return;}</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">        if(Main.getPe().getVisible()){</span>
<span class="nc" id="L57">          Main.getPe().setVisible(false);</span>
        }else{
<span class="nc" id="L59">          Main.getPj().setDesc(&quot;&quot;);</span>
<span class="nc" id="L60">          Main.getPe().setVisible(true);</span>
        }
<span class="nc" id="L62">      }</span>
    };
<span class="nc" id="L64">    actionMap.put(&quot;escape&quot;,action);</span>

<span class="nc" id="L66">    action = new AbstractAction() {</span>
      /**
      *{@summary Try to go to next PanneauDialogue.}
      *@version 1.40
      */
      public void actionPerformed(ActionEvent actionEvent) {
        try {
<span class="nc" id="L73">          Main.getPd().clicEn(0,0);</span>
<span class="nc" id="L74">        }catch (Exception e) {}</span>
<span class="nc" id="L75">      }</span>
    };
<span class="nc" id="L77">    actionMap.put(&quot;space&quot;,action);</span>

<span class="nc" id="L79">    action = new AbstractAction() {</span>
      /**
      *{@summary Launch game or swap plaing ant or end turn.}
      *@version 1.40
      */
      public void actionPerformed(ActionEvent actionEvent) {
        // if (Main.getPd()!=null) {
        //   try {
        //     Main.getPd().clicEn(0,0);
        //   }catch (Exception e) {}
<span class="nc bnc" id="L89" title="All 2 branches missed.">        if(Main.getPlayingAnt()!=null){</span>
          //TODO passer le tour ou a la prochaine Fourmi qui a des actions.
<span class="nc bnc" id="L91" title="All 2 branches missed.">        }else if (Main.getPch()!=null) {</span>
<span class="nc" id="L92">          Main.getPch().setLancer(true);</span>
        }
<span class="nc" id="L94">      }</span>
    };
<span class="nc" id="L96">    actionMap.put(&quot;enter&quot;,action);</span>

    //ants actions
<span class="nc" id="L99">    action = new AbstractAction() {</span>
      /**
      *{@summary Do an ant action.}
      *@version 1.40
      */
      public void actionPerformed(ActionEvent actionEvent) {
<span class="nc bnc" id="L105" title="All 2 branches missed.">        if(Main.getPlayingAnt()==null){return;}</span>
<span class="nc" id="L106">        char c = actionEvent.getActionCommand().charAt(0);</span>
<span class="nc" id="L107">        System.out.println(actionEvent);</span>
<span class="nc" id="L108">        System.out.println(c);</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">        for (int i=20;i&lt;31 ;i++ ) {</span>
          try {
<span class="nc" id="L111">            debug.débogage(&quot;comparaisons de la clé avec &quot;+Main.getKey(i+&quot;&quot;));</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">            if(c==Main.getKey(i+&quot;&quot;)){ // les actions des fourmis</span>
<span class="nc" id="L113">              Main.getPb().setActionF(i-20);return;</span>
            }
<span class="nc" id="L115">          }catch (Exception e) {</span>
<span class="nc" id="L116">            erreur.erreur(&quot;la clé d'action de fourmi &quot;+i+&quot; n'as pas été trouvée.&quot;);</span>
<span class="nc" id="L117">          }</span>
        }
<span class="nc" id="L119">      }</span>
    };
<span class="nc" id="L121">    actionMap.put(&quot;antAction&quot;,action);</span>
<span class="nc" id="L122">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>